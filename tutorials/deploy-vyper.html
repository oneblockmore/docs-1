<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Deploying Vyper Contracts on Oasis (Uniswap) | Oasis Dev Docs</title>
    <meta name="description" content="Oasis Developer Documentation">
    <link rel="icon" href="/favicon.ico">
  <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-116576458-1"></script>
  <script>window.dataLayer = window.dataLayer || [];
       function gtag(){dataLayer.push(arguments);}
       gtag('js', new Date());
       gtag('config', 'UA-116576458-1');</script>
  <script>var APP_ID = "scny7003";

       window.intercomSettings = {
         app_id: APP_ID
       };

       function intercom(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/' + APP_ID;var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}};
       intercom();
      </script>
    
    <link rel="preload" href="/assets/css/0.styles.028774a9.css" as="style"><link rel="preload" href="/assets/js/app.04080b29.js" as="script"><link rel="preload" href="/assets/js/2.25f8aa4f.js" as="script"><link rel="preload" href="/assets/js/29.b8fc95dc.js" as="script"><link rel="prefetch" href="/assets/js/10.5665b1ea.js"><link rel="prefetch" href="/assets/js/11.0b9b05df.js"><link rel="prefetch" href="/assets/js/12.6befbe01.js"><link rel="prefetch" href="/assets/js/13.94852edb.js"><link rel="prefetch" href="/assets/js/14.326177c3.js"><link rel="prefetch" href="/assets/js/15.04dc1a7e.js"><link rel="prefetch" href="/assets/js/16.d604b220.js"><link rel="prefetch" href="/assets/js/17.a7dff11c.js"><link rel="prefetch" href="/assets/js/18.581de73a.js"><link rel="prefetch" href="/assets/js/19.31e3d100.js"><link rel="prefetch" href="/assets/js/20.188d04aa.js"><link rel="prefetch" href="/assets/js/21.281a02f4.js"><link rel="prefetch" href="/assets/js/22.a245b48b.js"><link rel="prefetch" href="/assets/js/23.55f9d7e6.js"><link rel="prefetch" href="/assets/js/24.9f8000dd.js"><link rel="prefetch" href="/assets/js/25.a924b745.js"><link rel="prefetch" href="/assets/js/26.14372b06.js"><link rel="prefetch" href="/assets/js/27.a08f8fbe.js"><link rel="prefetch" href="/assets/js/28.b4bf067a.js"><link rel="prefetch" href="/assets/js/3.9cedb76e.js"><link rel="prefetch" href="/assets/js/30.9c20a5d0.js"><link rel="prefetch" href="/assets/js/31.9892d0bf.js"><link rel="prefetch" href="/assets/js/32.77fe67cf.js"><link rel="prefetch" href="/assets/js/4.5a843e98.js"><link rel="prefetch" href="/assets/js/5.7141f6c7.js"><link rel="prefetch" href="/assets/js/6.5d6c237a.js"><link rel="prefetch" href="/assets/js/7.d81a6c3a.js"><link rel="prefetch" href="/assets/js/8.69735e7d.js"><link rel="prefetch" href="/assets/js/9.6477dfd4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.028774a9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.svg" alt="Oasis Dev Docs" class="logo"> <span class="site-name can-hide">Oasis Dev Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://oasislabs.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://dashboard.oasiscloud.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dashboard
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://join.slack.com/t/oasiscommunity/shared_invite/enQtNjQ5MTA3NTgyOTkzLWIxNTg1ZWZmOTIwNmQ2MTg1YmU0MzgyMzk3OWM2ZWQ4NTQ0ZDJkNTBmMTdlM2JhODllYjg5YmJkODc2NzgwNTg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Support
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/oasislabs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://oasislabs.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://dashboard.oasiscloud.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dashboard
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://join.slack.com/t/oasiscommunity/shared_invite/enQtNjQ5MTA3NTgyOTkzLWIxNTg1ZWZmOTIwNmQ2MTg1YmU0MzgyMzk3OWM2ZWQ4NTQ0ZDJkNTBmMTdlM2JhODllYjg5YmJkODc2NzgwNTg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Support
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/oasislabs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/overview.html" class="sidebar-link">Overview</a></li><li><a href="/quickstart.html" class="sidebar-link">Quickstart</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Tutorials</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tutorials/ballot.html" class="sidebar-link">Beginner: Secret Ballot</a></li><li><a href="/tutorials/messaging.html" class="sidebar-link">Intermediate: Private Chat</a></li><li><a href="/tutorials/web3-intro.html" class="sidebar-link">Getting Started With Web3</a></li><li><a href="/tutorials/deploy-solidity.html" class="sidebar-link">Deploy Solidity Contract: Compound</a></li><li><a href="/tutorials/deploy-vyper.html" class="active sidebar-link">Deploy Vyper Contract: Uniswap</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tutorials/deploy-vyper.html#prerequisites" class="sidebar-link">Prerequisites</a></li><li class="sidebar-sub-header"><a href="/tutorials/deploy-vyper.html#compiling-the-contracts" class="sidebar-link">Compiling the Contracts</a></li><li class="sidebar-sub-header"><a href="/tutorials/deploy-vyper.html#deploying-the-contracts" class="sidebar-link">Deploying the Contracts</a></li><li class="sidebar-sub-header"><a href="/tutorials/deploy-vyper.html#testing-the-deployment" class="sidebar-link">Testing the Deployment</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Operator Docs</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>API Reference</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="deploying-vyper-contracts-on-oasis-uniswap"><a href="#deploying-vyper-contracts-on-oasis-uniswap" class="header-anchor">#</a> Deploying Vyper Contracts on Oasis (Uniswap)</h1> <p>This tutorial demonstrates how to deploy Vyper contracts onto the Oasis platform using Truffle and Web3.js.
These techniques should work with <em>any</em> Vyper contract, but we've chosen to use <a href="https://uniswap.io/" target="_blank" rel="noopener noreferrer">Uniswap<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> as an illustrative example.
Uniswap is an open-source decentralized exchange (DEX) for ERC20 tokens built on Ethereum.
This tutorial's methods for deploying Vyper contracts using Truffle and Web3.js are applicable to any Ethereum contract written in Vyper.
For contracts written in Solidity, see the <a href="/tutorials/deploy-solidity.html">Solidity tutorial</a>.</p> <p>If you want to deploy the contracts for yourself, a copy of the Uniswap contracts along with a <code>truffle.js</code> file and sample deployment through <code>Web3</code> can be found <a href="https://github.com/oasislabs/uniswap" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h2 id="prerequisites"><a href="#prerequisites" class="header-anchor">#</a> Prerequisites</h2> <p>You will need to have installed the Oasis Toolchain and know your public address. Click <a href="/tutorials/deploy-solidity.html#prerequisites">here</a> for more information.</p> <h2 id="compiling-the-contracts"><a href="#compiling-the-contracts" class="header-anchor">#</a> Compiling the Contracts</h2> <h3 id="install-vyper"><a href="#install-vyper" class="header-anchor">#</a> Install Vyper</h3> <p>Clone the <a href="https://github.com/ethereum/vyper" target="_blank" rel="noopener noreferrer">Vyper repository<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> clone https://github.com/ethereum/vyper
<span class="token builtin class-name">cd</span> vyper
</code></pre></div><p>To retrieve the version that the Uniswap contracts are compatible with, you should reset to a previous version. If you don't have the correct version, you may get compiler errors.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> reset --hard 35038d20bd9946a35261c4c4fbcb27fe61e65f78
</code></pre></div><p>Vyper requires Python version 3.6 or higher. The best way to install vyper is to use <code>virtualenv</code> to create a python virtual environment:</p> <p>First make sure you have Python 3.6 installed, then get your path to python 3.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">which</span> python3
</code></pre></div><p>Start a virtualenv.</p> <div class="language- extra-class"><pre class="language-text"><code>virtualenv -p /path/to/python3.6 my_project
source my_project/bin/activate
</code></pre></div><p>Then, run <code>make</code> in your <code>vyper</code> directory. You may need to use <code>sudo</code> if on mac:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">make</span>
</code></pre></div><p>Vyper should be installed now and you should be able to compile contracts.
The <a href="https://vyper.readthedocs.io/en/latest/installing-vyper.html" target="_blank" rel="noopener noreferrer">Vyper Documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> has more installation information.</p> <p>Uniswap Vyper contracts can be found <a href="https://github.com/Uniswap/contracts-vyper" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.
You can compile using the <code>vyper</code> command or using Truffle.</p> <div class="language- extra-class"><pre class="language-text"><code>vyper uniswap_factory.vy
vyper uniswap_exchange.vy
</code></pre></div><p>Don't forget to deactivate your virtualenv at the end.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>deactivate
</code></pre></div><h2 id="deploying-the-contracts"><a href="#deploying-the-contracts" class="header-anchor">#</a> Deploying the Contracts</h2> <h3 id="deploy-using-truffle"><a href="#deploy-using-truffle" class="header-anchor">#</a> Deploy Using Truffle</h3> <p>If you choose to deploy using Truffle, you'll need to create migrations contracts.</p> <p>The first are a <code>Migrations.sol</code> in your project's <code>./contracts</code> folder and <code>1_initial_migrations</code> in your project's <code>./migrations</code> folder, both of which can be automatically generated using <code>truffle init</code>.</p> <p>You also need a <code>2_deploy_contracts</code> which should look like this:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> uniswap_exchange <span class="token operator">=</span> artifacts<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./uniswap_exchange'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//note there is no '.vy'</span>
<span class="token keyword">var</span> uniswap_factory <span class="token operator">=</span> artifacts<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./uniswap_factory'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//note there is no '.vy'</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">deployer<span class="token punctuation">,</span> network<span class="token punctuation">,</span> accounts</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  deployer<span class="token punctuation">.</span><span class="token function">deploy</span><span class="token punctuation">(</span>uniswap_exchange<span class="token punctuation">,</span> accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  deployer<span class="token punctuation">.</span><span class="token function">deploy</span><span class="token punctuation">(</span>uniswap_factory<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Run <code>truffle migrate</code> to deploy.</p> <h3 id="deploy-using-web3"><a href="#deploy-using-web3" class="header-anchor">#</a> Deploy Using Web3</h3> <p>First, connect to Web3 using a <code>truffle-hdwallet-provider</code>. You can run <code>oasis chain</code> to start up a local blockchain server and retrieve your mnemonic and URL.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> Web3 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'web3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HDWalletProvider <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'truffle-hdwallet-provider'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">MNEMONIC</span> <span class="token operator">=</span> <span class="token string">'range drive remove bleak mule satisfy mandate east lion minimum unfold ready'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">URL</span> <span class="token operator">=</span> <span class="token string">'http://localhost:8545'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> provider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HDWalletProvider</span><span class="token punctuation">(</span><span class="token constant">MNEMONIC</span><span class="token punctuation">,</span> <span class="token constant">URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> web3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Web3</span><span class="token punctuation">(</span>provider<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Using the contract ABI and bytecode from the compilation of your vyper contracts, instantiate new contract objects.
Uniswap requires a <strong>factory</strong> contract to create new exchanges, and an <strong>exchange</strong> contract that serves as a template for each exchange.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> factory_json <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./path/to/file.json'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> factory_abi <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>factory_json<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'abi'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> factory_bytecode <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>factory_json<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'bytecode'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> exchange_json <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./path/to/file.json'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> exchange_abi <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>exchange_json<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'abi'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> exchange_bytecode <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>exchange_json<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'bytecode'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>Initialize your contract objects.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> factory_contract <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>Contract</span><span class="token punctuation">(</span>factory_abi<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> exchange_contract <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>Contract</span><span class="token punctuation">(</span>exchange_abi<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Finally, deploy your contracts and save their addresses for future use.</p> <div class="language-js extra-class"><pre class="language-js"><code>factory_contract<span class="token punctuation">.</span><span class="token function">deploy</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    data<span class="token punctuation">:</span> factory_bytecode<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token keyword">from</span><span class="token punctuation">:</span> my_address<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Deploy failed with error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">deployment</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Factory deployed successfully, at address: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>deployment<span class="token punctuation">.</span>options<span class="token punctuation">.</span>address<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    factory_contract<span class="token punctuation">.</span>options<span class="token punctuation">.</span>address <span class="token operator">=</span> deployment<span class="token punctuation">.</span>options<span class="token punctuation">.</span>address<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exchange_contract<span class="token punctuation">.</span><span class="token function">deploy</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    data<span class="token punctuation">:</span> exchange_bytecode<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token keyword">from</span><span class="token punctuation">:</span> my_address<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Deploy failed with error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">deployment</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Exchange deployed successfully: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>deployment<span class="token punctuation">.</span>options<span class="token punctuation">.</span>address<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    exchange_contract<span class="token punctuation">.</span>options<span class="token punctuation">.</span>address <span class="token operator">=</span> deployment<span class="token punctuation">.</span>options<span class="token punctuation">.</span>address<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The HD Wallet Provider may continue running and cause execution to hang at the end. To gracefully exit, use the stop function:</p> <div class="language-js extra-class"><pre class="language-js"><code>provider<span class="token punctuation">.</span>engine<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="testing-the-deployment"><a href="#testing-the-deployment" class="header-anchor">#</a> Testing the Deployment</h2> <p>Once you've deployed your contracts, you can interact with them!
Try initializing the factory by giving it a template (the exchange contract address).
Make sure to do all of this before you call the stop function.</p> <p>Assuming you have your factory and exchange contracts already deployed, fill these in with their corresponding addresses:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> factory_address <span class="token operator">=</span> <span class="token string">'0x...'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> exchange_address <span class="token operator">=</span> <span class="token string">'0x...'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> factory_contract <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>Contract</span><span class="token punctuation">(</span>factory_abi<span class="token punctuation">,</span> factory_address<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> exchange_contract <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>Contract</span><span class="token punctuation">(</span>exchange_abi<span class="token punctuation">,</span> exchange_address<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>To initialize the factory:</p> <div class="language-js extra-class"><pre class="language-js"><code>factory_contract<span class="token punctuation">.</span>methods<span class="token punctuation">.</span><span class="token function">initializeFactory</span><span class="token punctuation">(</span>exchange_address<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token keyword">from</span><span class="token punctuation">:</span> my_address<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    factory_contract<span class="token punctuation">.</span>methods<span class="token punctuation">.</span><span class="token function">exchangeTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\n\nSuccessfully initialized Uniswap factory with template: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>You can also create a new exchange for the ERC20 token of your choice. All you need is the address to the token contract.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> token_address <span class="token operator">=</span> <span class="token string">'0x...'</span><span class="token punctuation">;</span>
factory_contract<span class="token punctuation">.</span>methods<span class="token punctuation">.</span><span class="token function">createExchange</span><span class="token punctuation">(</span>token_address<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token keyword">from</span><span class="token punctuation">:</span> my_address<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  factory_contract<span class="token punctuation">.</span>methods<span class="token punctuation">.</span><span class="token function">getExchange</span><span class="token punctuation">(</span> token_contract<span class="token punctuation">.</span>options<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Successfully created a new exchange for token at </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Now you can deploy and interact with any Vyper contract on the Oasis platform!</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/oasislabs/docs/edit/master/src/tutorials/deploy-vyper.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/tutorials/deploy-solidity.html" class="prev">Deploy Solidity Contract: Compound</a></span> <span class="next"><a href="/operators/overview.html">Node Operator Overview</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.04080b29.js" defer></script><script src="/assets/js/2.25f8aa4f.js" defer></script><script src="/assets/js/29.b8fc95dc.js" defer></script>
  </body>
</html>
